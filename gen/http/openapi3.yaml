openapi: 3.0.3
info:
  title: Spin API service
  description: HTTP service for controlling the spin service
  version: "1.0"
servers:
- url: http://localhost:8080
paths:
  /add/{id}:
    post:
      tags:
      - spin-broker
      summary: add spin-broker
      description: Add a command to the package
      operationId: spin-broker#add
      parameters:
      - name: id
        in: path
        description: Package ID
        required: true
        schema:
          type: string
          description: Package ID
          example: Qui quibusdam odio est nulla eum.
        example: Cupiditate neque eos aperiam.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AddRequestBody'
            example:
              action: Mollitia natus temporibus fugit occaecati ipsum qui.
              parameters:
                Aut molestiae deleniti ad dolorem.: Rerum quam adipisci est incidunt sequi.
              resource: Possimus velit quod sit.
      responses:
        "200":
          description: OK response.
          content:
            application/json:
              schema:
                type: string
                example: Odit tenetur cupiditate amet fugiat.
              example: Sunt doloremque.
  /complete:
    post:
      tags:
      - spin-broker
      summary: complete spin-broker
      description: Mark a command as completed with a result status
      operationId: spin-broker#complete
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CompleteRequestBody'
            example:
              id: Quas tempora nisi aperiam occaecati deserunt qui.
              status: false
              status_reason: Esse reprehenderit qui molestias eum voluptatem.
      responses:
        "200":
          description: OK response.
  /create:
    post:
      tags:
      - spin-registry
      summary: create spin-registry
      description: Create a VM
      operationId: spin-registry#create
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateRequestBody'
            example:
              cpus: 9896149697376370528
              memory: 12073838662949931649
              name: Nihil officia aspernatur.
              storage:
              - image: In aut vero amet.
                image_size: 4230286153146778503
                volume: Voluptatibus est minima cum delectus occaecati.
              - image: In aut vero amet.
                image_size: 4230286153146778503
                volume: Voluptatibus est minima cum delectus occaecati.
              - image: In aut vero amet.
                image_size: 4230286153146778503
                volume: Voluptatibus est minima cum delectus occaecati.
              - image: In aut vero amet.
                image_size: 4230286153146778503
                volume: Voluptatibus est minima cum delectus occaecati.
      responses:
        "200":
          description: OK response.
          content:
            application/json:
              schema:
                type: integer
                example: 6537776878665164718
              example: 13641496883989394131
  /delete/{id}:
    post:
      tags:
      - spin-registry
      summary: delete spin-registry
      description: Delete a VM by ID
      operationId: spin-registry#delete
      parameters:
      - name: id
        in: path
        description: ID of VM to remove
        required: true
        schema:
          type: integer
          description: ID of VM to remove
          example: 4443863834301358860
        example: 6001672524861556042
      responses:
        "200":
          description: OK response.
  /enqueue/{id}:
    post:
      tags:
      - spin-broker
      summary: enqueue spin-broker
      description: Enqueue the package into the various resource queues
      operationId: spin-broker#enqueue
      parameters:
      - name: id
        in: path
        description: Package ID
        required: true
        schema:
          type: string
          description: Package ID
          example: Sint ut perspiciatis.
        example: Quos maxime ut error facilis modi autem.
      responses:
        "200":
          description: OK response.
          content:
            application/json:
              schema:
                type: array
                items:
                  type: string
                  example: Sequi molestiae inventore aut consequatur officiis perspiciatis.
                example:
                - Voluptate voluptas veniam.
                - Eum laudantium tempora pariatur possimus autem.
                - Qui ad aut possimus quisquam harum.
              example:
              - Nam aut deserunt modi qui.
              - Placeat rem ullam.
              - Ea at ut.
              - Expedita voluptatem reiciendis voluptatem dicta.
  /get/{id}:
    get:
      tags:
      - spin-registry
      summary: get spin-registry
      description: Retrieve a VM by ID
      operationId: spin-registry#get
      parameters:
      - name: id
        in: path
        description: ID of VM to remove
        required: true
        schema:
          type: integer
          description: ID of VM to remove
          example: 4321987282516396767
        example: 9797683867806913265
      responses:
        "200":
          description: OK response.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CreateRequestBody'
              example:
                cpus: 10847116477577916963
                memory: 4597833110689897909
                name: Minima recusandae.
                storage:
                - image: Sapiente temporibus.
                  image_size: 4310599689986484391
                  volume: Voluptas perferendis ea iusto.
                - image: Sapiente temporibus.
                  image_size: 4310599689986484391
                  volume: Voluptas perferendis ea iusto.
                - image: Sapiente temporibus.
                  image_size: 4310599689986484391
                  volume: Voluptas perferendis ea iusto.
  /list:
    get:
      tags:
      - spin-registry
      summary: list spin-registry
      description: Retrieve all VM IDs
      operationId: spin-registry#list
      responses:
        "200":
          description: OK response.
          content:
            application/json:
              schema:
                type: array
                items:
                  type: integer
                  example: 2387996022125123884
                example:
                - 8701067751308364928
                - 798591105205778312
                - 12261922440318303718
                - 14618798313825648874
              example:
              - 3343293614547310319
              - 10184839825487979141
              - 10819130854463063230
              - 13624580516412824510
  /new:
    post:
      tags:
      - spin-broker
      summary: new spin-broker
      description: Create a new package; a collection of items to join into the queue simultaneously
      operationId: spin-broker#new
      responses:
        "200":
          description: OK response.
          content:
            application/json:
              schema:
                type: string
                example: Quae at sed necessitatibus et.
              example: Quis sed voluptas omnis.
  /next/{resource}:
    get:
      tags:
      - spin-broker
      summary: next spin-broker
      description: Get the next command for a given resource
      operationId: spin-broker#next
      parameters:
      - name: resource
        in: path
        description: resource type
        required: true
        schema:
          type: string
          description: resource type
          example: Fugiat distinctio eveniet assumenda temporibus.
        example: Qui illo eos repudiandae et vel.
      responses:
        "200":
          description: OK response.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NextResponseBody'
              example:
                action: Unde inventore cupiditate soluta.
                parameters:
                  Sit non sit recusandae eum.: Earum provident sint eveniet hic minus facere.
                resource: Iure aut voluptas qui.
                uuid: Consequatur quo exercitationem occaecati magnam molestiae qui.
        "400":
          description: No records were found
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
              example:
                id: 3F1FKVRR
                message: Value of ID must be an integer
                name: bad_request
  /status/{id}:
    get:
      tags:
      - spin-broker
      summary: status spin-broker
      description: Get the status for a package
      operationId: spin-broker#status
      parameters:
      - name: id
        in: path
        description: Package ID
        required: true
        schema:
          type: string
          description: Package ID
          example: Tenetur qui.
        example: Et magnam sed iusto quam non.
      responses:
        "200":
          description: OK response.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StatusResponseBody'
              example:
                reason: Illum omnis suscipit illum repellendus.
                status: false
        "400":
          description: No records were found
          content:
            application/vnd.goa.error:
              schema:
                $ref: '#/components/schemas/Error'
              example:
                id: 3F1FKVRR
                message: Value of ID must be an integer
                name: bad_request
  /storage/volume/add:
    post:
      tags:
      - spin-apiserver
      summary: add_volume spin-apiserver
      description: Add a volume for image allocation with backing storage, and name it
      operationId: spin-apiserver#add_volume
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AddVolumeRequestBody'
            example:
              path: Commodi sed et consequatur sunt.
              volume: Quis at distinctio magni quibusdam reiciendis.
      responses:
        "200":
          description: OK response.
  /storage/volume/image/create:
    post:
      tags:
      - spin-apiserver
      summary: create_image_on_volume spin-apiserver
      description: Create an image on a volume
      operationId: spin-apiserver#create_image_on_volume
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateImageOnVolumeRequestBody'
            example:
              image_name: Rem qui quia voluptas.
              image_size: 2016887882939484835
              volume: Dicta quisquam.
      responses:
        "200":
          description: OK response.
  /storage/volume/image/delete:
    post:
      tags:
      - spin-apiserver
      summary: delete_image_on_volume spin-apiserver
      description: Delete an image on a volume
      operationId: spin-apiserver#delete_image_on_volume
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/DeleteImageOnVolumeRequestBody'
            example:
              image_name: Qui ut.
              volume: Est reprehenderit.
      responses:
        "200":
          description: OK response.
  /storage/volume/image/info/{volume}/{image_name}:
    get:
      tags:
      - spin-apiserver
      summary: info_image_on_volume spin-apiserver
      description: Obtain information on an image
      operationId: spin-apiserver#info_image_on_volume
      parameters:
      - name: volume
        in: path
        description: volume identifier
        required: true
        schema:
          type: string
          description: volume identifier
          example: Recusandae unde sed.
        example: Nihil error.
      - name: image_name
        in: path
        description: image name
        required: true
        schema:
          type: string
          description: image name
          example: Minima fugit.
        example: Recusandae in voluptas laborum corrupti.
      responses:
        "200":
          description: OK response.
  /storage/volume/image/move:
    post:
      tags:
      - spin-apiserver
      summary: move_image spin-apiserver
      description: Move an image from one volume to another
      operationId: spin-apiserver#move_image
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/MoveImageRequestBody'
            example:
              image_name: Id et autem ut debitis.
              target_volume: Quaerat itaque aut.
              volume: Saepe occaecati impedit quas laborum.
      responses:
        "200":
          description: OK response.
  /storage/volume/image/resize:
    post:
      tags:
      - spin-apiserver
      summary: resize_image_on_volume spin-apiserver
      description: Resize an image on a volume
      operationId: spin-apiserver#resize_image_on_volume
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateImageOnVolumeRequestBody'
            example:
              image_name: Nesciunt omnis voluptatem ullam.
              image_size: 7948336710745379137
              volume: Sint ad ut nulla.
      responses:
        "200":
          description: OK response.
  /storage/volume/info/{volume}:
    get:
      tags:
      - spin-apiserver
      summary: info_volume spin-apiserver
      description: Get information on a volume
      operationId: spin-apiserver#info_volume
      parameters:
      - name: volume
        in: path
        description: volume identifier
        required: true
        schema:
          type: string
          description: volume identifier
          example: Optio nemo dolor doloremque similique eligendi veniam.
        example: Sint voluptatem.
      responses:
        "200":
          description: OK response.
  /storage/volume/label/{volume}/{label}:
    post:
      tags:
      - spin-apiserver
      summary: label_volume spin-apiserver
      description: Apply a label to a volume.
      operationId: spin-apiserver#label_volume
      parameters:
      - name: volume
        in: path
        description: volume identifier
        required: true
        schema:
          type: string
          description: volume identifier
          example: Quasi consequatur.
        example: Sed fugiat autem ut modi.
      - name: label
        in: path
        description: label identifier to apply to volume
        required: true
        schema:
          type: string
          description: label identifier to apply to volume
          example: Quo cum fugit facere ea voluptas libero.
        example: Repudiandae illum ut.
      responses:
        "200":
          description: OK response.
  /storage/volume/remove/{volume}:
    post:
      tags:
      - spin-apiserver
      summary: remove_volume spin-apiserver
      description: Remove a volume. Requires all images to be removed.
      operationId: spin-apiserver#remove_volume
      parameters:
      - name: volume
        in: path
        description: volume identifier
        required: true
        schema:
          type: string
          description: volume identifier
          example: Aut dolores quod mollitia est.
        example: Libero nisi.
      responses:
        "200":
          description: OK response.
  /update/{id}:
    post:
      tags:
      - spin-registry
      summary: update spin-registry
      description: Update a VM
      operationId: spin-registry#update
      parameters:
      - name: id
        in: path
        description: ID of VM to update
        required: true
        schema:
          type: integer
          description: ID of VM to update
          example: 10559257291347331479
        example: 10639272094763521843
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateRequestBody'
            example:
              vm:
                cpus: 6421225864845588134
                memory: 15540618699971399982
                name: Et dicta.
                storage:
                - image: In aut vero amet.
                  image_size: 4230286153146778503
                  volume: Voluptatibus est minima cum delectus occaecati.
                - image: In aut vero amet.
                  image_size: 4230286153146778503
                  volume: Voluptatibus est minima cum delectus occaecati.
                - image: In aut vero amet.
                  image_size: 4230286153146778503
                  volume: Voluptatibus est minima cum delectus occaecati.
                - image: In aut vero amet.
                  image_size: 4230286153146778503
                  volume: Voluptatibus est minima cum delectus occaecati.
      responses:
        "200":
          description: OK response.
components:
  schemas:
    AddRequestBody:
      type: object
      properties:
        action:
          type: string
          description: Action name
          example: Animi fugiat excepturi sed.
        parameters:
          type: object
          description: Action parameters
          example:
            In repudiandae.: Eveniet repudiandae.
            Tempore aliquam quae illum molestiae voluptates.: Neque qui iusto ex et doloremque.
          additionalProperties: true
        resource:
          type: string
          description: Resource name
          example: Earum hic sequi.
      example:
        action: Dolores reprehenderit quo ab iure.
        parameters:
          Non officiis molestiae nostrum quia quisquam.: Est quisquam inventore quae.
          Nulla sit.: Minima voluptas dolorem et corporis quo dolores.
        resource: Perferendis impedit.
      required:
      - resource
      - action
    AddVolumeRequestBody:
      type: object
      properties:
        path:
          type: string
          description: path to backing storage
          example: Saepe consectetur commodi accusamus veritatis quos reiciendis.
        volume:
          type: string
          description: volume identifier
          example: Quidem numquam provident occaecati.
      example:
        path: In animi quos voluptatem qui explicabo.
        volume: Quisquam ex officia voluptas voluptate.
      required:
      - volume
      - path
    CompleteRequestBody:
      type: object
      properties:
        id:
          type: string
          description: Command ID
          example: Labore labore accusantium ut itaque odio.
        status:
          type: boolean
          description: status of work
          example: false
        status_reason:
          type: string
          description: reason of success/failure
          example: Quaerat totam quia sit cum.
      example:
        id: Tempora qui.
        status: false
        status_reason: Rerum hic.
      required:
      - id
      - status
    CreateImageOnVolumeRequestBody:
      type: object
      properties:
        image_name:
          type: string
          description: image name
          example: Officiis voluptatum deleniti maxime possimus vero.
        image_size:
          type: integer
          description: image size in GB
          example: 15073861021373345776
        volume:
          type: string
          description: volume identifier
          example: Qui sint delectus quis.
      example:
        image_name: Recusandae nobis.
        image_size: 9099737587732154848
        volume: Nihil tempora eum officiis sit quis itaque.
      required:
      - image_name
      - image_size
      - volume
    CreateRequestBody:
      type: object
      properties:
        cpus:
          type: integer
          description: CPU count
          example: 11690391126467062567
        memory:
          type: integer
          description: Memory (in megabytes)
          example: 4645972946162694718
        name:
          type: string
          description: Name of VM; does not need to be unique
          example: In qui eaque omnis odio quia.
        storage:
          type: array
          items:
            $ref: '#/components/schemas/Storage'
          description: Storage references
          example:
          - image: In aut vero amet.
            image_size: 4230286153146778503
            volume: Voluptatibus est minima cum delectus occaecati.
          - image: In aut vero amet.
            image_size: 4230286153146778503
            volume: Voluptatibus est minima cum delectus occaecati.
          - image: In aut vero amet.
            image_size: 4230286153146778503
            volume: Voluptatibus est minima cum delectus occaecati.
      example:
        cpus: 4047906078158329845
        memory: 1280107851555459435
        name: Dicta dignissimos optio quisquam.
        storage:
        - image: In aut vero amet.
          image_size: 4230286153146778503
          volume: Voluptatibus est minima cum delectus occaecati.
        - image: In aut vero amet.
          image_size: 4230286153146778503
          volume: Voluptatibus est minima cum delectus occaecati.
      required:
      - name
      - cpus
      - memory
      - storage
    DeleteImageOnVolumeRequestBody:
      type: object
      properties:
        image_name:
          type: string
          description: image name
          example: Qui recusandae.
        volume:
          type: string
          description: volume identifier
          example: Blanditiis repudiandae.
      example:
        image_name: Accusantium consequuntur.
        volume: Et inventore.
      required:
      - image_name
      - volume
    Error:
      type: object
      properties:
        fault:
          type: boolean
          description: Is the error a server-side fault?
          example: false
        id:
          type: string
          description: ID is a unique identifier for this particular occurrence of the problem.
          example: 123abc
        message:
          type: string
          description: Message is a human-readable explanation specific to this occurrence of the problem.
          example: parameter 'p' must be an integer
        name:
          type: string
          description: Name is the name of this class of errors.
          example: bad_request
        temporary:
          type: boolean
          description: Is the error temporary?
          example: true
        timeout:
          type: boolean
          description: Is the error a timeout?
          example: false
      example:
        id: 3F1FKVRR
        message: Value of ID must be an integer
        name: bad_request
      required:
      - name
      - id
      - message
      - temporary
      - timeout
      - fault
    MoveImageRequestBody:
      type: object
      properties:
        image_name:
          type: string
          description: image name
          example: Molestias deserunt dicta eaque reiciendis autem exercitationem.
        target_volume:
          type: string
          description: volume identifier to move to
          example: Perspiciatis in.
        volume:
          type: string
          description: volume identifier
          example: Esse blanditiis qui repellendus voluptate.
      example:
        image_name: Delectus sequi temporibus repudiandae inventore cupiditate commodi.
        target_volume: Cum repudiandae veniam vel.
        volume: Asperiores quidem sit facilis.
      required:
      - image_name
      - volume
      - target_volume
    NextResponseBody:
      type: object
      properties:
        action:
          type: string
          description: action name
          example: Tempora quisquam inventore inventore qui nihil.
        parameters:
          type: object
          description: parameters for action
          example:
            Consectetur optio sint.: Nesciunt et molestiae soluta ut animi.
            Tempore iste voluptatem est.: Deserunt blanditiis consequatur consequuntur praesentium consequatur.
            Totam omnis molestiae.: Rerum libero quas.
          additionalProperties: true
        resource:
          type: string
          description: resource type
          example: Aut architecto deleniti incidunt alias.
        uuid:
          type: string
          description: Command ID
          example: Rerum eos ut.
      example:
        action: Corporis ab nulla quis.
        parameters:
          Aut similique aliquid.: Amet numquam sed totam accusantium minima.
          Quia culpa.: Quidem aut et qui.
          Vel dicta consequuntur tempora dolorem quibusdam minus.: Doloremque et iusto.
        resource: Accusantium labore.
        uuid: Sunt iusto harum.
      required:
      - uuid
      - resource
      - action
    StatusResponseBody:
      type: object
      properties:
        reason:
          type: string
          description: Failure reason (if any)
          example: Natus quasi quia vel ut.
        status:
          type: boolean
          description: Pass/Fail status
          example: true
      example:
        reason: Cumque ratione occaecati.
        status: false
      required:
      - status
    Storage:
      type: object
      properties:
        image:
          type: string
          description: Image filename, must not include `/`
          example: Voluptas quae autem illum enim sequi soluta.
        image_size:
          type: integer
          description: Image size (in gigabytes)
          example: 8837125510370274380
        volume:
          type: string
          description: Volume name, must not include `/`
          example: Omnis dignissimos nihil soluta.
      example:
        image: Sit sit earum.
        image_size: 5204886235093605221
        volume: Autem ex tempora fugit adipisci aliquid aliquam.
      required:
      - volume
      - image
      - image_size
    UpdateRequestBody:
      type: object
      properties:
        vm:
          $ref: '#/components/schemas/CreateRequestBody'
      example:
        vm:
          cpus: 6421225864845588134
          memory: 15540618699971399982
          name: Et dicta.
          storage:
          - image: In aut vero amet.
            image_size: 4230286153146778503
            volume: Voluptatibus est minima cum delectus occaecati.
          - image: In aut vero amet.
            image_size: 4230286153146778503
            volume: Voluptatibus est minima cum delectus occaecati.
          - image: In aut vero amet.
            image_size: 4230286153146778503
            volume: Voluptatibus est minima cum delectus occaecati.
          - image: In aut vero amet.
            image_size: 4230286153146778503
            volume: Voluptatibus est minima cum delectus occaecati.
      required:
      - vm
